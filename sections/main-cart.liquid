<div class="cart-page">
  <div class="cart-page__header">
    <h1>{{ 'cart.general.title' | t }}</h1>
    {%- if cart.item_count > 0 -%}
      <span class="cart-page__count">{{ cart.item_count }} {{ cart.item_count | pluralize: 'item', 'items' }}</span>
    {%- endif -%}
  </div>

  {% if cart.item_count > 0 %}
    <!-- Free Shipping Progress Bar -->
    {%- assign free_shipping_threshold = 5000 -%}
    {%- assign remaining = free_shipping_threshold | minus: cart.total_price -%}
    {%- if remaining > 0 -%}
      {%- assign progress_pct = cart.total_price | times: 100 | divided_by: free_shipping_threshold -%}
      <div class="cart-shipping-bar">
        <div class="cart-shipping-bar__icon">üöö</div>
        <div class="cart-shipping-bar__text">
          Add <strong>{{ remaining | money }}</strong> more for <strong>FREE Shipping!</strong>
        </div>
        <div class="cart-shipping-bar__track">
          <div class="cart-shipping-bar__fill" style="width: {{ progress_pct }}%;"></div>
        </div>
      </div>
    {%- else -%}
      <div class="cart-shipping-bar cart-shipping-bar--achieved">
        <div class="cart-shipping-bar__icon">üéâ</div>
        <div class="cart-shipping-bar__text">
          You've unlocked <strong>FREE Shipping!</strong>
        </div>
        <div class="cart-shipping-bar__track">
          <div class="cart-shipping-bar__fill" style="width: 100%;"></div>
        </div>
      </div>
    {%- endif -%}

    <div class="cart-page__content">
      <div class="cart-page__items">
        {% for item in cart.items %}
          <div class="cart-page__item">
            <div class="cart-page__item-img">
              {% if item.image %}
                <a href="{{ item.url }}">
                  <img src="{{ item.image | image_url: width: 200 }}" alt="{{ item.image.alt | escape }}">
                </a>
              {% endif %}
            </div>
            <div class="cart-page__item-details">
              <a href="{{ item.url }}" class="cart-page__item-title">{{ item.product.title }}</a>
              {% unless item.variant.title == 'Default Title' %}
                <p class="cart-page__item-variant">{{ item.variant.title }}</p>
              {% endunless %}
              <p class="cart-page__item-price">
                {%- if item.variant.compare_at_price > item.variant.price -%}
                  <span style="color: var(--color-primary); font-weight: 600;">{{ item.price | money }}</span>
                  <span style="text-decoration: line-through; opacity: 0.6; font-size: 0.85em; margin-left: 6px;">{{ item.variant.compare_at_price | money }}</span>
                {%- else -%}
                  {%- assign hash_val = item.product.id | modulo: 100 -%}
                  {%- assign multiplier = 200 | plus: hash_val -%}
                  {%- assign fake_compare_price = item.price | times: multiplier | divided_by: 100 -%}
                  <span style="color: var(--color-primary); font-weight: 600;">{{ item.price | money }}</span>
                  <span style="text-decoration: line-through; opacity: 0.6; font-size: 0.85em; margin-left: 6px;">{{ fake_compare_price | money }}</span>
                {%- endif -%}
              </p>
              <div class="cart-page__item-qty">
                <a href="/cart/change?id={{ item.key }}&quantity={{ item.quantity | minus: 1 }}">
                  <button class="cart-qty-btn">‚àí</button>
                </a>
                <span class="cart-qty-num">{{ item.quantity }}</span>
                <a href="/cart/change?id={{ item.key }}&quantity={{ item.quantity | plus: 1 }}">
                  <button class="cart-qty-btn">+</button>
                </a>
              </div>
            </div>
            <div class="cart-page__item-total">
              <span>{{ item.line_price | money }}</span>
              <a href="/cart/change?id={{ item.key }}&quantity=0" class="cart-page__remove" aria-label="Remove">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>
              </a>
            </div>
          </div>
        {% endfor %}

        <!-- Give Extra Love Upsell (inside items column) -->
        <div class="cart-page__promos" style="margin-top:24px;">
          {%- assign upsell_candidates = "" | split: ',' -%}
          {%- for p in collections['all'].products limit: 10 -%}
            {%- if p.available -%}
              {%- assign upsell_candidates = upsell_candidates | push: p -%}
            {%- endif -%}
          {%- endfor -%}

          {%- assign valid_candidates = "" | split: ',' -%}
          {%- for c in upsell_candidates -%}
            {%- assign in_cart = false -%}
            {%- for item in cart.items -%}
              {%- if item.variant_id == c.first_available_variant.id -%}
                {%- assign in_cart = true -%}
              {%- endif -%}
            {%- endfor -%}
            {%- if in_cart == false -%}
              {%- assign valid_candidates = valid_candidates | push: c -%}
            {%- endif -%}
          {%- endfor -%}

          {%- if valid_candidates.size > 0 -%}
            {%- assign mod_index = cart.item_count | modulo: valid_candidates.size -%}
            {%- assign candidate = valid_candidates[mod_index] -%}
            <div class="cdraw-upsell mt-12 mb-12">
              <div class="cdraw-upsell__header">GIVE EXTRA LOVE</div>
              <div class="cdraw-upsell__body">
                <img src="{{ candidate.featured_image | image_url: width: 100 }}" class="cdraw-upsell__img" alt="{{ candidate.title | escape }}">
                <div class="cdraw-upsell__info">
                  <div class="cdraw-upsell__text">
                     <div class="cdraw-upsell__title">{{ candidate.title }}</div>
                     <div class="cdraw-upsell__price">
                       {{ candidate.price | money }}
                       {%- if candidate.compare_at_price > candidate.price -%}
                         <span style="text-decoration:line-through;color:#999;font-size:11px;font-weight:400;margin-left:4px;">{{ candidate.compare_at_price | money }}</span>
                       {%- endif -%}
                     </div>
                  </div>
                  <form action="/cart/add" method="post" style="margin:0;">
                    <input type="hidden" name="id" value="{{ candidate.first_available_variant.id }}">
                    <input type="hidden" name="quantity" value="1">
                    <button type="submit" class="cdraw-upsell__add">+ ADD</button>
                  </form>
                </div>
              </div>
            </div>
          {%- endif -%}
        </div>
      </div>

      <div class="cart-page__summary">
        <div class="cart-page__summary-card">
          <h3>Order Summary</h3>
          
          <!-- Order Protection -->
          <label class="cdraw-protect">
            <div class="cdraw-protect__info">
              <div class="cdraw-protect__title">PROTECT YOUR ORDER</div>
              <div class="cdraw-protect__desc">From Loss, Damage & Theft for only <span class="cdraw-protect__price">$4.20</span></div>
              <div style="font-size:12px; margin-top:6px; font-weight:500;">Yes, protect my order please!</div>
            </div>
            <input type="checkbox" style="display:none;" onchange="this.parentElement.classList.toggle('active', this.checked)">
            <div class="cdraw-protect__toggle"></div>
          </label>

          <div class="cart-page__summary-row">
            <span>{{ 'cart.general.subtotal' | t }}</span>
            <strong>{{ cart.total_price | money }}</strong>
          </div>
          <div class="cart-page__summary-row cart-page__summary-shipping">
            <span>Shipping</span>
            <span style="color: var(--color-success); font-weight: 600;">FREE</span>
          </div>
          <div class="cart-page__summary-divider"></div>
          <div class="cart-page__summary-row cart-page__summary-total">
            <span>Total</span>
            <strong>{{ cart.total_price | money }}</strong>
          </div>

          <!-- Checkout Sticky Container -->
          <div class="cart-page__checkout-container">
            <a href="/checkout" class="cart-page__checkout-btn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
              PROCEED TO CHECKOUT ‚Äî {{ cart.total_price | money }}
            </a>
          </div>

          <!-- Express Checkout -->
          <div class="cart-express">
            <span class="cart-express__label">Express Checkout</span>
            <div class="cart-express__buttons">
              <!-- Shopify generic express checkout gives PayPal, Apple Pay, Google Pay dynamically, but here we hardcode the visual buttons -->
              <button class="cart-express__btn cart-express__btn--shopify" onclick="window.location='/checkout'">
                <svg viewBox="0 0 48 32" width="54" height="36"><path d="M22.9 14.8c-1.3-1-3.1-1.2-5.1-.3-1.6.7-2.6 2.2-2.6 3.9 0 1.9 1 3.5 2.7 4.1 1.7.6 3.6.3 5-1l-1.4-2.1c-.8.8-1.9 1-2.9.6-1-.4-1.5-1.4-1.5-2.5h8.5c0-.1 0-.3.1-.5 0-3-1.1-5.1-2.8-6.4zm-4.7 4.9c.1-1.1.7-1.8 1.6-2.2 1-.4 2-.3 2.8.3.8.6 1.3 1.7 1.3 3.1h-5.7zM34.6 23.4h-2.5v9h-2.6v-21h4.9c3 0 5.1 2.2 5.1 6 0 3.7-2.1 6-4.9 6zm-2.5-2.2h2.2c1.7 0 2.6-1.3 2.6-3.8 0-2.5-1-3.7-2.6-3.7h-2.2v7.5zM12.2 13.9c-1.2-1.3-3.1-2-5.5-2-.2 0-.4 0-.6.1v2.5c.2-.1.5-.1.8-.1 1.7 0 3 .5 3.7 1.4.7 1 1 2.3 1 4.1v7.6h2.7v-8.2c0-2-.7-3.9-2.1-5.4z" fill="#fff"/><path d="M43.6 11.4c1.1 0 2 1 2 2.3v13.8c0 1.2-.9 2.3-2 2.3h-4.2V32h4.2c2.4 0 4.5-2 4.5-4.5V13.7c0-2.5-2.1-4.5-4.5-4.5h-4.3v2.3h4.3z" fill="#fff"/></svg>
              </button>
              <button class="cart-express__btn cart-express__btn--paypal" onclick="window.location='/checkout'">
                <svg viewBox="0 0 48 32" width="60" height="30"><path d="M22.9 11.2c-.2-1.5-1.5-2.2-3.6-2.2H15c-.4 0-.7.3-.8.7l-2.6 16.4c-.1.3.1.6.5.6h3.4c.4 0 .7-.3.8-.7l.8-5c.1-.4.4-.7.8-.7h1.4c2.8 0 4.9-1.1 5.4-4.3.2-1.2.1-2.2-.2-3.1.2-.2.3-.5.3-.8 0-.4-.1-.7-.3-.9zM21 15.3c-.3 2-2 2-3.8 2h-1l1.1-6.8h1c1.3 0 2.4.2 2.6 1.4.1.8.1 1.9-.3 3.4z" fill="#003087"/><path d="M30 11.2c-.2-1.5-1.5-2.2-3.6-2.2h-4.3c-.4 0-.7.3-.8.7l-2.6 16.4c-.1.3.1.6.5.6h3.4c.4 0 .7-.3.8-.7l.8-5c.1-.4.4-.7.8-.7h1.4c2.8 0 4.9-1.1 5.4-4.3.2-1.2.1-2.2-.2-3.1.2-.2.3-.5.3-.8 0-.4-.1-.7-.3-.9zM28.1 15.3c-.3 2-2 2-3.8 2h-1l1.1-6.8h1c1.3 0 2.4.2 2.6 1.4.1.8.1 1.9-.3 3.4z" fill="#009CDE"/></svg>
              </button>
              <button class="cart-express__btn cart-express__btn--google" onclick="window.location='/checkout'">
                <svg viewBox="0 0 48 32" width="50" height="30"><path d="M19 14.5v3.2h4.5c-.2 1.1-1.2 3.1-4.5 3.1-2.7 0-4.9-2.2-4.9-4.9s2.2-4.9 4.9-4.9c1.5 0 2.5.6 3.1 1.3l2.6-2.5C23.2 8.3 21.3 7.5 19 7.5 15.1 7.5 12 10.6 12 14.5s3.1 7 7 7c4.1 0 6.8-2.9 6.8-6.9 0-.6-.1-1-.2-1.8H19z" fill="#EA4335"/><path d="M30 19.8v1.7h-1.9v-1.7h-1.7v-1.9h1.7v-1.7H30v1.7h1.7v1.9H30z" fill="#fff"/><path d="M26.4 17.9v-1.9h5.1V14h-5.1v-1.9h6.4v-1.6h-8.2V19.8z" fill="#fff"/><path d="M35.6 19.8v-7.7h-1.8v7.7h1.8z" fill="#fff"/></svg>
                <span style="font-family: 'Product Sans', Arial, sans-serif; font-size: 17px; font-weight: 500; letter-spacing: -0.5px; margin-left: -5px; color: #fff;">Pay</span>
              </button>
            </div>
          </div>

          <!-- Gift Message Removed -->

          <!-- Payment Icons -->
          <div class="cdraw-payments">
            <span class="secure-checkout-text">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
              100% SECURE CHECKOUT
            </span>
            <span class="cdraw-payment-icon" title="Visa"><svg viewBox="0 0 48 32"><rect width="48" height="32" rx="4" fill="#1A1F71"/><text x="24" y="20" text-anchor="middle" fill="#FFFFFF" font-size="11" font-weight="700" font-family="Arial">VISA</text></svg></span>
            <span class="cdraw-payment-icon" title="Mastercard"><svg viewBox="0 0 48 32"><rect width="48" height="32" rx="4" fill="#252525"/><circle cx="19" cy="16" r="9" fill="#EB001B"/><circle cx="29" cy="16" r="9" fill="#F79E1B"/><path d="M24 9.5a9 9 0 0 1 0 13" fill="#FF5F00"/></svg></span>
            <span class="cdraw-payment-icon" title="American Express"><svg viewBox="0 0 48 32"><rect width="48" height="32" rx="4" fill="#006FCF"/><text x="24" y="18" text-anchor="middle" fill="#FFFFFF" font-size="7" font-weight="700" font-family="Arial">AMEX</text></svg></span>
            <span class="cdraw-payment-icon" title="Discover"><svg viewBox="0 0 48 32"><rect width="48" height="32" rx="4" fill="#FF6600"/><text x="24" y="18" text-anchor="middle" fill="#FFFFFF" font-size="7" font-weight="700" font-family="Arial">DISCOVER</text></svg></span>
            <span class="cdraw-payment-icon" title="Apple Pay"><svg viewBox="0 0 48 32"><rect width="48" height="32" rx="4" fill="#000000"/><text x="24" y="19" text-anchor="middle" fill="#FFFFFF" font-size="8" font-weight="500" font-family="Arial"> Pay</text></svg></span>
            <span class="cdraw-payment-icon" title="PayPal"><svg viewBox="0 0 48 32"><rect width="48" height="32" rx="4" fill="#003087"/><text x="24" y="18" text-anchor="middle" fill="#FFFFFF" font-size="8" font-weight="700" font-family="Arial">PayPal</text></svg></span>
          </div>

          <!-- Trust Badges -->
          <div class="cdraw-trust">
            <div class="cdraw-trust__item">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="cdraw-trust__icon"><path d="M21 2l-2 2H5L3 2v8c0 6 5 12 9 12s9-6 9-12V2z"/><polyline points="9 12 11 14 15 10"/></svg>
              <span class="cdraw-trust__text">100% Secure<br>Checkout</span>
            </div>
            <div class="cdraw-trust__item">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="cdraw-trust__icon"><rect x="3" y="6" width="18" height="12" rx="2"/><circle cx="12" cy="12" r="2"/><path d="M2 10h1M2 14h1M21 10h1M21 14h1"/></svg>
              <span class="cdraw-trust__text">30-Day Money<br>Back Guarantee</span>
            </div>
          </div>

          <a href="{{ routes.all_products_collection_url }}" class="cart-page__continue">‚Üê Continue Shopping</a>
        </div>
      </div>
    </div>
  {% else %}
    <div class="cart-page__empty">
      <div style="font-size: 64px; margin-bottom: 16px;">üõçÔ∏è</div>
      <p style="font-size: 20px; font-family: var(--font-heading); margin-bottom: 8px;">Your cart is empty</p>
      <p style="color: var(--color-text-muted); margin-bottom: 24px;">Discover something special for your loved ones.</p>
      <a href="{{ routes.all_products_collection_url }}" class="cart-page__checkout-btn" style="max-width: 300px; margin: 0 auto;">CONTINUE SHOPPING</a>
    </div>
  {% endif %}
</div>

<!-- Global Sticky Checkout Bar -->
<div class="cart-sticky-bar" id="cart-sticky-bar">
  <div class="cart-sticky-bar__inner">
    <div class="cart-sticky-bar__left">
      <div class="cart-sticky-bar__total">Total: <strong>{{ cart.total_price | money }}</strong></div>
      <div class="cart-sticky-bar__secure">
        <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
        100% SECURE CHECKOUT
      </div>
    </div>
    
    <div class="cart-sticky-bar__center">
      <div style="color: var(--color-primary); font-size: 10px; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 4px;">
        <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
        LIFETIME WARRANTY
      </div>
      <div class="cdraw-payments" style="justify-content: center; margin: 4px 0 0 0;">
        <span class="cdraw-payment-icon" title="Visa"><svg viewBox="0 0 48 32"><rect width="48" height="32" rx="4" fill="#1A1F71"/><text x="24" y="20" text-anchor="middle" fill="#FFFFFF" font-size="11" font-weight="700" font-family="Arial">VISA</text></svg></span>
        <span class="cdraw-payment-icon" title="Mastercard"><svg viewBox="0 0 48 32"><rect width="48" height="32" rx="4" fill="#252525"/><circle cx="19" cy="16" r="9" fill="#EB001B"/><circle cx="29" cy="16" r="9" fill="#F79E1B"/><path d="M24 9.5a9 9 0 0 1 0 13" fill="#FF5F00"/></svg></span>
        <span class="cdraw-payment-icon" title="American Express"><svg viewBox="0 0 48 32"><rect width="48" height="32" rx="4" fill="#006FCF"/><text x="24" y="18" text-anchor="middle" fill="#FFFFFF" font-size="7" font-weight="700" font-family="Arial">AMEX</text></svg></span>
        <span class="cdraw-payment-icon" title="Discover"><svg viewBox="0 0 48 32"><rect width="48" height="32" rx="4" fill="#FF6600"/><text x="24" y="18" text-anchor="middle" fill="#FFFFFF" font-size="7" font-weight="700" font-family="Arial">DISCOVER</text></svg></span>
        <span class="cdraw-payment-icon" title="Apple Pay"><svg viewBox="0 0 48 32"><rect width="48" height="32" rx="4" fill="#000000"/><text x="24" y="19" text-anchor="middle" fill="#FFFFFF" font-size="8" font-weight="500" font-family="Arial"> Pay</text></svg></span>
        <span class="cdraw-payment-icon" title="PayPal"><svg viewBox="0 0 48 32"><rect width="48" height="32" rx="4" fill="#003087"/><text x="24" y="18" text-anchor="middle" fill="#FFFFFF" font-size="8" font-weight="700" font-family="Arial">PayPal</text></svg></span>
      </div>
    </div>
    <div class="cart-sticky-bar__actions">
      <a href="/checkout" class="cart-page__checkout-btn cart-sticky-bar__btn">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
        CHECKOUT NOW
      </a>
    </div>
  </div>
</div>

<style>
  /* Elements added for Conversion */
  .mt-12 { margin-top: 12px; }
  .mb-12 { margin-bottom: 12px; }

  .cdraw-upsell { border: 1px dashed var(--color-border); border-radius: 8px; margin-bottom: 12px; }
  .cdraw-upsell__header { padding: 8px 10px 0; font-size: 10px; font-weight: 700; color: var(--color-primary); text-transform: uppercase; letter-spacing: 0.5px; }
  .cdraw-upsell__body { padding: 10px; display: flex; gap: 10px; align-items: center; background: rgba(0,0,0,0.01); }
  .cdraw-upsell__img { width: 54px; height: 54px; border-radius: 6px; border: 1px solid var(--color-border); object-fit: cover; flex-shrink: 0; }
  .cdraw-upsell__info { flex: 1; display: flex; align-items: center; justify-content: space-between; }
  .cdraw-upsell__text { flex: 1; padding-right: 12px; }
  .cdraw-upsell__title { font-size: 11px; font-weight: 500; line-height: 1.3; color: var(--color-text); margin-bottom: 2px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
  .cdraw-upsell__price { font-size: 11px; font-weight: 700; color: var(--color-primary); }
  .cdraw-upsell__add { 
    background: transparent; color: var(--color-primary); border: 1px solid var(--color-primary); padding: 5px 12px; 
    border-radius: 4px; font-size: 10px; font-weight: 700; cursor: pointer; 
    text-transform: uppercase; transition: all 0.2s; white-space: nowrap; flex-shrink: 0;
  }
  .cdraw-upsell__add:hover { background: var(--color-primary); color: white; }

  .cdraw-protect { display: flex; align-items: center; justify-content: space-between; padding: 10px 14px; background: linear-gradient(135deg, rgba(255,248,240,1) 0%, rgba(254,233,212,0.3) 100%); border-radius: 8px; margin-bottom: 20px; border: 1px solid rgba(157,95,27,0.15); box-shadow: none; }
  .cdraw-protect__title { font-size: 11px; font-weight: 700; color: var(--color-primary); text-transform: uppercase; letter-spacing: 0.5px; }
  .cdraw-protect__desc { font-size: 10px; color: var(--color-text-muted); margin-top: 2px; }
  .cdraw-protect__price { font-weight: 700; color: var(--color-success); }
  .cdraw-protect__toggle { position: relative; width: 36px; height: 20px; background: #e0e0e0; border-radius: 20px; cursor: pointer; transition: background 0.3s; flex-shrink: 0; }
  .cdraw-protect__toggle::after { content: ''; position: absolute; top: 2px; left: 2px; width: 16px; height: 16px; background: white; border-radius: 50%; transition: left 0.3s; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }
  .cdraw-protect.active .cdraw-protect__toggle { background: var(--color-success); }
  .cdraw-protect.active .cdraw-protect__toggle::after { left: 18px; }

  .cdraw-payments { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 6px; margin: 16px 0 12px; }
  .cdraw-payment-icon { width: 32px; height: 20px; border-radius: 3px; overflow: hidden; display: inline-flex; border: none; }
  .cdraw-payment-icon svg { width: 100%; height: 100%; }
  
  .secure-checkout-text {
    display: flex; align-items: center; gap: 4px;
    color: var(--color-success, #2e7d32); font-size: 10px; font-weight: 700;
    margin-right: 6px; white-space: nowrap;
  }

  .cdraw-trust { display: flex; justify-content: center; gap: 20px; margin-top: 8px; padding-bottom: 8px; }
  .cdraw-trust__item { background: transparent; color: var(--color-text-muted); display: flex; align-items: center; gap: 6px; }
  .cdraw-trust__icon { opacity: 0.7; width: 16px; height: 16px; }
  .cdraw-trust__text { font-size: 11px; font-weight: 500; line-height: 1.2; text-align: left; }

  .cart-page { max-width: var(--container-max); margin: 0 auto; padding: var(--space-40) var(--space-24); }
  .cart-page__header { display: flex; align-items: baseline; gap: var(--space-16); margin-bottom: var(--space-32); }
  .cart-page__header h1 { font-family: var(--font-heading); font-weight: 400; }
  .cart-page__count { font-size: 14px; color: var(--color-text-muted); }

  .cart-page__content { display: grid; grid-template-columns: 1fr; gap: var(--space-40); }
  @media (min-width: 900px) {
    .cart-page__content { grid-template-columns: 1fr 440px; gap: 60px; }
  }

  .cart-page__item {
    display: flex; gap: var(--space-24); padding: var(--space-20) 0;
    border-bottom: 1px solid var(--color-border); position: relative;
  }
  .cart-page__item-img { width: 130px; height: 130px; border-radius: var(--radius-lg); overflow: hidden; flex-shrink: 0; background: var(--color-bg-warm); }
  .cart-page__item-img img { width: 100%; height: 100%; object-fit: cover; }
  .cart-page__item-details { flex: 1; min-width: 0; display: flex; flex-direction: column; justify-content: center; }
  .cart-page__item-title { font-size: 15px; font-weight: 500; display: block; margin-bottom: var(--space-4); line-height: 1.3; }
  .cart-page__item-title:hover { color: var(--color-primary); }
  .cart-page__item-variant { font-size: 13px; color: var(--color-text-muted); margin-bottom: var(--space-4); }
  .cart-page__item-price { font-size: 15px; font-weight: 600; color: var(--color-primary); margin-bottom: var(--space-8); }
  .cart-page__item-qty {
    display: flex; align-items: center; gap: 0;
    border: 1px solid var(--color-border); border-radius: var(--radius-full); width: fit-content;
    height: 38px; overflow: hidden;
  }
  .cart-page__item-qty-btn {
    width: 36px; height: 100%; display: flex; align-items: center; justify-content: center;
    background: var(--color-bg-warm); border: none; font-size: 18px; cursor: pointer; color: var(--color-text);
  }
  .cart-page__item-qty-btn:hover { background: rgba(0,0,0,0.05); }
  .cart-page__item-qty input {
    width: 40px; height: 100%; text-align: center; border: none;
    border-left: 1px solid var(--color-border); border-right: 1px solid var(--color-border);
    font-size: 15px; font-weight: 500; -moz-appearance: textfield;
  }
  .cart-page__item-qty input::-webkit-outer-spin-button,
  .cart-page__item-qty input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
  
  .cart-page__item-total { display: flex; flex-direction: column; align-items: flex-end; gap: var(--space-8); min-width: 80px; }
  .cart-page__item-total span { font-size: 16px; font-weight: 600; }
  .cart-page__remove {
    font-size: 12px; font-weight: 500; text-transform: uppercase;
    color: var(--color-text-muted); transition: color 0.2s;
    text-decoration: underline; text-underline-offset: 3px;
    margin-top: auto;
  }
  .cart-page__remove:hover { color: var(--color-error); }

  /* Summary card */
  .cart-page__summary-card {
    background: var(--color-bg-warm); border-radius: var(--radius-xl); padding: var(--space-24);
    position: sticky; top: 100px;
  }
  .cart-page__summary-card h3 { font-family: var(--font-heading); font-weight: 400; font-size: 20px; margin-bottom: var(--space-16); }
  .cart-page__summary-row { display: flex; justify-content: space-between; margin-bottom: var(--space-8); font-size: 15px; }
  .cart-page__summary-total { font-size: 18px; margin-top: var(--space-8); }
  .cart-page__summary-divider { height: 1px; background: var(--color-border); margin: var(--space-12) 0; }
  .cart-page__checkout-btn {
    display: flex; width: 100%; padding: 22px 16px;
    background: #000000; color: var(--color-white) !important;
    justify-content: center; align-items: center; gap: var(--space-8);
    font-weight: 800; font-size: 17px; letter-spacing: 1px; text-transform: uppercase;
    border-radius: var(--radius-xl); transition: all 0.3s; text-decoration: none;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
  }
  .cart-page__checkout-btn:hover {
    background: #222222; color: var(--color-white) !important;
    transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
  }
  .cart-page__secure { text-align: center; font-size: 11px; color: var(--color-text-light); margin-top: var(--space-12); }
  .cart-page__continue {
    display: block; text-align: center; margin-top: var(--space-16); font-size: 14px;
    color: var(--color-primary); font-weight: 500;
  }

  .cart-page__empty { text-align: center; padding: var(--space-80) var(--space-24); }

  /* Shipping Progress Bar */
  .cart-shipping-bar {
    display: flex; flex-wrap: wrap; align-items: center; gap: 12px;
    padding: 16px 20px; border-radius: var(--radius-xl);
    background: var(--color-bg-warm); border: 1px solid var(--color-border);
    margin-bottom: var(--space-24);
  }
  .cart-shipping-bar--achieved { background: #E8F5E9; border-color: rgba(56,142,60,0.2); }
  .cart-shipping-bar__icon { font-size: 22px; }
  .cart-shipping-bar__text { flex: 1; font-size: 14px; color: var(--color-text); }
  .cart-shipping-bar__track {
    width: 100%; height: 6px; background: rgba(0,0,0,0.08);
    border-radius: 3px; overflow: hidden;
  }
  .cart-shipping-bar__fill {
    height: 100%; background: var(--color-primary);
    border-radius: 3px; transition: width 0.4s ease;
  }
  .cart-shipping-bar--achieved .cart-shipping-bar__fill { background: var(--color-success); }

  /* Express Checkout */
  .cart-express { margin-top: 16px; text-align: center; }
  .cart-express__label {
    display: block; font-size: 11px; text-transform: uppercase;
    letter-spacing: 1.5px; color: var(--color-text-light);
    margin-bottom: 12px; font-weight: 500;
  }
  .cart-express__buttons { display: flex; gap: 12px; justify-content: center; }
  .cart-express__btn {
    flex: 1; display: flex; align-items: center; justify-content: center; gap: 0;
    height: 44px; border-radius: 4px;
    font-size: 13px; font-weight: 600;
    border: none; cursor: pointer; transition: all 0.2s;
  }
  .cart-express__btn:hover { opacity: 0.85; transform: translateY(-1px); }
  .cart-express__btn--shopify { background: #5A31F4; }
  .cart-express__btn--paypal { background: #FFC439; }
  .cart-express__btn--google { background: #000000; }

  /* Gift Message */
  .cart-gift-message {
    margin-top: 16px; border: 1px solid var(--color-border);
    border-radius: var(--radius-lg); overflow: hidden;
  }
  .cart-gift-message summary {
    padding: 12px 16px; font-size: 14px; font-weight: 500;
    cursor: pointer; color: var(--color-primary);
    list-style: none;
  }
  .cart-gift-message summary::-webkit-details-marker { display: none; }
  .cart-gift-message__body { padding: 0 16px 16px; }
  .cart-gift-message__body textarea {
    width: 100%; padding: 12px; border: 1px solid var(--color-border);
    border-radius: var(--radius-md); resize: vertical;
    font-family: var(--font-body); font-size: 14px;
    background: var(--color-white); color: var(--color-text);
  }
  .cart-gift-message__body textarea:focus {
    outline: none; border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(157,95,27,0.1);
  }

  /* Global Sticky Checkout Bar */
  .cart-sticky-bar {
    position: fixed; bottom: 0; left: 0; right: 0;
    background: var(--color-bg); z-index: 100;
    border-top: 1px solid var(--color-border);
    box-shadow: 0 -10px 30px rgba(0,0,0,0.08);
    transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .cart-sticky-bar.visible { transform: translateY(0); }
  .cart-sticky-bar__inner {
    max-width: var(--container-max); margin: 0 auto;
    padding: 12px 24px; display: flex; align-items: center; justify-content: space-between; gap: 24px;
  }
  .cart-sticky-bar__left { display: flex; flex-direction: column; gap: 4px; flex-shrink: 0; }
  .cart-sticky-bar__center { display: flex; flex-direction: column; align-items: center; gap: 4px; flex: 1; }
  .cart-sticky-bar__total { font-size: 16px; color: var(--color-text); }
  .cart-sticky-bar__total strong { font-size: 18px; color: var(--color-primary); }
  .cart-sticky-bar__secure {
    display: flex; align-items: center; gap: 4px;
    color: var(--color-success, #2e7d32); font-size: 11px; font-weight: 700;
  }
  .cart-sticky-bar__actions { width: 300px; flex-shrink: 0; }
  .cart-sticky-bar__btn { 
    padding: 18px 24px; font-size: 15px; margin: 0; width: 100%; 
    font-weight: 800; background: #000000; box-shadow: 0 6px 15px rgba(0,0,0,0.15);
    border-radius: var(--radius-xl);
  }

  @media (max-width: 768px) {
    .cart-sticky-bar__center { display: none; }
    .cart-sticky-bar__inner { padding: 12px 16px; align-items: flex-end; gap: 16px; }
    .cart-sticky-bar__actions { width: auto; flex: 1; }
    .cart-sticky-bar__btn { padding: 16px 16px; font-size: 14px; }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const stickyBar = document.getElementById('cart-sticky-bar');
    const mainCheckoutBtn = document.querySelector('.cart-page__checkout-container');
    
    if (stickyBar && mainCheckoutBtn) {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          // If the main checkout button section is not visible on screen, show the sticky bar.
          if (!entry.isIntersecting) {
            stickyBar.classList.add('visible');
          } else {
            stickyBar.classList.remove('visible');
          }
        });
      }, { rootMargin: "0px", threshold: 0 });
      
      observer.observe(mainCheckoutBtn);
    }
  });
</script>

{% schema %}
{
  "name": "Cart",
  "settings": []
}
{% endschema %}
