{% comment %}
  Happy Customers Page - Full Width Masonry with Interactive Modal
{% endcomment %}

{%- assign rev_names = "Gabriel W.|Liam S.|Matthew W.|Thomas R.|Mia N.|Robert L.|Alexander L.|Lucas J.|Sophie H.|Hannah W.|Eva J.|Danielle V.|Jason F.|Chloe T.|Sarah P.|David K.|Emily R." | split: "|" -%}
{%- assign hc_countries = "ðŸ‡ºðŸ‡¸ USA|ðŸ‡¬ðŸ‡§ UK|ðŸ‡¨ðŸ‡¦ CAN|ðŸ‡©ðŸ‡ª GER|ðŸ‡«ðŸ‡· FRA|ðŸ‡ºðŸ‡¸ USA|ðŸ‡¬ðŸ‡§ UK|ðŸ‡¨ðŸ‡¦ CAN|ðŸ‡®ðŸ‡¹ ITA|ðŸ‡ºðŸ‡¸ USA|ðŸ‡ªðŸ‡¸ ESP|ðŸ‡ºðŸ‡¸ USA|ðŸ‡¬ðŸ‡§ UK|ðŸ‡¨ðŸ‡¦ CAN|ðŸ‡«ðŸ‡· FRA|ðŸ‡©ðŸ‡ª GER|ðŸ‡ºðŸ‡¸ USA" | split: "|" -%}
{%- assign rev_texts = "Bought for my fiancÃ©eâ€™s birthday. She was extremely happy with it.|Got this for our anniversary and my wife was amazed by the hidden necklace.|I gave this to my mother just because, and it made her day.|Such a meaningful gift, my mom was genuinely moved.|Best gift ever! The packaging and the necklace are both flawless.|Beautiful craftmanship. Will definitely order again for future occasions.|She cried when she saw it. 10/10 would buy again! Best gift ever.|Stunning presentation and the necklace shines brilliantly.|So dainty and beautiful. This is something I'll cherish forever.|Exceeded expectations. Fast shipping and amazing quality.|This beats a regular bouquet of flowers any day of the week!|So cute and such a lovely surprise. I adore every detail about it.|Gifted this to my mom and she has it displayed proudly. She loved it!|The attention to detail is crazy. Such a luxurious feel.|Nailed our 5 year anniversary with this gift. She absolutely loved it.|Prettiest thing I own right now. Going to buy one for my best friend too.|This gift is absolutely breathtaking. He surprised me with it!" | split: "|" -%}

<div class="hc-page">
  <div class="hc-page__header">
    <div class="hc-page__header-inner">
      <h1 class="hc-page__title">Happy Customers</h1>
      
      <div class="hc-page__stats">
        <div class="hc-page__rating-num">4.8</div>
        <div class="hc-page__rating-info">
          <div class="hc-page__stars-large">
            <svg viewBox="0 0 24 24" fill="#d4af37"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
            <svg viewBox="0 0 24 24" fill="#d4af37"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
            <svg viewBox="0 0 24 24" fill="#d4af37"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
            <svg viewBox="0 0 24 24" fill="#d4af37"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
            <svg viewBox="0 0 24 24" fill="#d4af37"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
          </div>
          <div class="hc-page__review-count">Based on 10,248 reviews</div>
        </div>
      </div>

      <div class="hc-page__filters">
        <button class="hc-filter-btn is-active" data-filter="photo">Photos</button>
        <button class="hc-filter-btn" data-filter="video">Videos</button>
      </div>
    </div>
  </div>

  <div class="hc-grid-container">
    <div class="hc-masonry">
      {%- assign all_products = collections.all.products -%}
      {%- for i in (1..17) -%}
        {%- assign idx = i | minus: 1 -%}
        {%- capture rev_num_str -%}{%- if i < 10 -%}0{{ i }}{%- else -%}{{ i }}{%- endif -%}{%- endcapture -%}
        {%- assign prod_idx = idx | modulo: all_products.size -%}
        {%- assign rev_product = all_products[prod_idx] -%}

        <!-- Card / 15% chance to be a video placeholder just for layout simulation -->
        {%- assign is_video = false -%}
        {%- assign rand_mod = i | modulo: 4 -%}
        {%- if rand_mod == 0 -%}{%- assign is_video = true -%}{%- endif -%}
        
        <div class="hc-card" data-type="{% if is_video %}video{% else %}photo{% endif %}" onclick="openHcModal({{ idx }})">
          <div class="hc-card__img-wrap">
            <img src="{{ 'review-' | append: rev_num_str | append: '.jpg' | asset_url }}" alt="Review by {{ rev_names[idx] }}" loading="lazy">
            {%- if is_video -%}
            <div class="hc-card__play-icon">
              <svg viewBox="0 0 24 24" fill="white"><path d="M8 5v14l11-7z"/></svg>
            </div>
            {%- endif -%}
          </div>
          <div class="hc-card__body">
            <div class="hc-card__author-row">
              <span class="hc-card__name">{{ rev_names[idx] }} <span class="hc-country-badge">{{ hc_countries[idx] }}</span></span>
              <span class="hc-card__verified">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                Verified
              </span>
            </div>
            <div class="hc-card__stars">â˜…â˜…â˜…â˜…â˜…</div>
            <p class="hc-card__text">{{ rev_texts[idx] }}</p>
            
            {%- if rev_product -%}
            <div class="hc-card__divider"></div>
            <div class="hc-card__product">
              <img src="{{ rev_product.featured_image | image_url: width: 60 }}" alt="" class="hc-card__product-img">
              <span class="hc-card__product-title">{{ rev_product.title | truncate: 60 }}</span>
            </div>
            {%- endif -%}
          </div>
        </div>
      {%- endfor -%}
    </div>
  </div>
</div>

<!-- Modal -->
<div class="hc-modal" id="hcModal">
  <div class="hc-modal__overlay" onclick="closeHcModal()"></div>
  <div class="hc-modal__wrap">
    <button class="hc-modal__close" onclick="closeHcModal()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
    </button>
    <div class="hc-modal__content" id="hcModalContent">
      <!-- Filled via JS -->
    </div>
  </div>
</div>

<!-- JS Data -->
<script>
  window.hcReviewsData = [
    {%- for i in (1..17) -%}
      {%- assign idx = i | minus: 1 -%}
      {%- capture rev_num_str -%}{%- if i < 10 -%}0{{ i }}{%- else -%}{{ i }}{%- endif -%}{%- endcapture -%}
      {%- assign prod_idx = idx | modulo: all_products.size -%}
      {%- assign rev_product = all_products[prod_idx] -%}
      {%- assign is_video = false -%}
      {%- assign rand_mod = i | modulo: 4 -%}
      {%- if rand_mod == 0 -%}{%- assign is_video = true -%}{%- endif -%}
      {%- assign rand_vid = i | modulo: 8 | plus: 1 -%}
      {
        image: "{{ 'review-' | append: rev_num_str | append: '.jpg' | asset_url }}",
        is_video: {{ is_video }},
        video_url: "{% if is_video %}{{ 'ugc-video-' | append: rand_vid | append: '.mp4' | asset_url }}{% endif %}",
        name: "{{ rev_names[idx] }}",
        country: "{{ hc_countries[idx] }}",
        text: "{{ rev_texts[idx] | replace: '"', '\"' }}",
        product_title: "{{ rev_product.title | escape | upcase }}",
        product_url: "{{ rev_product.url }}",
        product_image: "{{ rev_product.featured_image | image_url: width: 120 }}"
      }{% unless forloop.last %},{% endunless %}
    {%- endfor -%}
  ];

  function openHcModal(idx) {
    const data = window.hcReviewsData[idx];
    if (!data) return;

    const mediaHtml = data.is_video 
      ? `<video src="${data.video_url}" autoplay controls loop muted playsinline style="width:100%; height:100%; object-fit:cover; display:block; max-height:80vh;"></video>`
      : `<img src="${data.image}" alt="Review Image">`;

    const html = `
      <div class="hc-modal__split">
        <div class="hc-modal__col-img">
          ${mediaHtml}
        </div>
        <div class="hc-modal__col-text">
          <div class="hc-modal__author-row">
            <span class="hc-modal__name">${data.name} <span class="hc-country-badge">${data.country}</span></span>
            <span class="hc-modal__verified">
              <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
              Verified
            </span>
          </div>
          <div class="hc-modal__stars">â˜…â˜…â˜…â˜…â˜…</div>
          <p class="hc-modal__review-text">${data.text}</p>
          
          <div class="hc-modal__divider"></div>
          
          <div class="hc-modal__product-area">
            <div class="hc-modal__product-info">
              <img src="${data.product_image}" alt="Product">
              <span class="hc-modal__product-title">${data.product_title}</span>
            </div>
            <a href="${data.product_url}" class="hc-modal__btn">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path></svg>
              View product
            </a>
          </div>
        </div>
      </div>
    `;

    document.getElementById('hcModalContent').innerHTML = html;
    document.getElementById('hcModal').classList.add('is-active');
    document.body.style.overflow = 'hidden';
  }

  function closeHcModal() {
    document.getElementById('hcModal').classList.remove('is-active');
    document.body.style.overflow = '';
    // Small delay to clear content after animation
    setTimeout(() => {
      document.getElementById('hcModalContent').innerHTML = '';
    }, 300);
  }

  // Filter Logic
  document.addEventListener("DOMContentLoaded", () => {
    const filterBtns = document.querySelectorAll('.hc-filter-btn');
    const cards = document.querySelectorAll('.hc-card');

    filterBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        // Active state handling
        filterBtns.forEach(b => b.classList.remove('is-active'));
        btn.classList.add('is-active');

        const filterVal = btn.getAttribute('data-filter');

        // Filter cards
        cards.forEach(card => {
          if (filterVal === 'all') {
            card.style.display = 'block';
          } else {
            if (card.getAttribute('data-type') === filterVal) {
              card.style.display = 'block';
            } else {
              card.style.display = 'none';
            }
          }
        });
      });
    });

    // Initialize default filter state (Photos)
    const activeBtn = document.querySelector('.hc-filter-btn.is-active');
    if (activeBtn) activeBtn.click();
  });
</script>

<style>
  .hc-page {
    background: var(--color-bg);
    min-height: 100vh;
    padding-bottom: 80px;
  }
  .hc-page__header {
    background: var(--color-bg-warm);
    border-bottom: 1px solid var(--color-border);
    margin-bottom: 40px;
    padding: 60px 20px 0;
  }
  .hc-page__header-inner {
    max-width: 800px;
    margin: 0 auto;
    text-align: center;
  }
  .hc-page__title {
    font-family: var(--font-heading);
    font-size: 38px;
    margin: 0 0 20px 0;
    color: #111;
  }

  /* Stats Block */
  .hc-page__stats {
    display: inline-flex;
    align-items: center;
    gap: 16px;
    background: #fff;
    padding: 16px 32px;
    border-radius: 50px;
    margin-bottom: 40px;
    border: 1px solid var(--color-border);
    box-shadow: 0 4px 15px rgba(0,0,0,0.02);
  }
  .hc-page__rating-num {
    font-size: 32px;
    font-weight: 700;
    color: var(--color-text);
    line-height: 1;
  }
  .hc-page__rating-info {
    text-align: left;
  }
  .hc-page__stars-large {
    display: flex;
    gap: 2px;
    margin-bottom: 4px;
  }
  .hc-page__stars-large svg {
    width: 20px; height: 20px;
  }
  .hc-page__review-count {
    font-size: 13px;
    color: #666;
    letter-spacing: 0.02em;
  }

  /* Filters */
  .hc-page__filters {
    display: flex;
    justify-content: center;
    gap: 12px;
    transform: translateY(50%);
  }
  .hc-filter-btn {
    background: #fff;
    border: 1px solid var(--color-border);
    padding: 10px 24px;
    border-radius: 50px;
    font-size: 14px;
    font-weight: 600;
    color: var(--color-text-muted);
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 4px 10px rgba(0,0,0,0.02);
  }
  .hc-filter-btn:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
  }
  .hc-filter-btn.is-active {
    background: var(--color-primary);
    color: #fff;
    border-color: var(--color-primary);
  }

  .hc-grid-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 20px;
  }

  .hc-masonry {
    column-count: 2;
    column-gap: 20px;
  }
  @media (min-width: 768px) { .hc-masonry { column-count: 3; } }
  @media (min-width: 1024px) { .hc-masonry { column-count: 4; column-gap: 24px; } }

  .hc-card {
    background: #fff;
    border-radius: 16px;
    overflow: hidden;
    margin-bottom: 24px;
    break-inside: avoid;
    box-shadow: 0 4px 15px rgba(0,0,0,0.02);
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
    border: 1px solid rgba(190,52,78,0.1); /* Subtle pink theme border */
  }
  .hc-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 25px rgba(190,52,78,0.06);
  }

  .hc-card__img-wrap {
    position: relative;
  }
  .hc-card__img-wrap img {
    width: 100%;
    display: block;
    object-fit: cover;
  }
  .hc-card__play-icon {
    position: absolute;
    top: 12px;
    right: 12px;
    width: 32px;
    height: 32px;
    background: rgba(0,0,0,0.5);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(4px);
  }
  .hc-card__play-icon svg {
    width: 18px; height: 18px;
    margin-left: 2px;
  }

  .hc-card__body {
    padding: 16px;
  }

  .hc-card__author-row, .hc-modal__author-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 6px;
  }
  .hc-card__name, .hc-modal__name {
    font-weight: 700;
    font-size: 14px;
    color: var(--color-text);
    display: flex;
    align-items: center;
  }
  .hc-modal__name { font-size: 16px; }

  .hc-country-badge {
    background: var(--color-bg-warm);
    color: var(--color-text-muted);
    font-size: 10px;
    font-weight: 600;
    padding: 2px 6px;
    border-radius: 4px;
    border: 1px solid var(--color-border);
    margin-left: 8px;
  }

  .hc-card__verified, .hc-modal__verified {
    font-size: 12px;
    color: var(--color-text-muted);
    display: flex;
    align-items: center;
    gap: 4px;
  }
  .hc-card__verified svg, .hc-modal__verified svg {
    width: 14px; height: 14px;
  }

  .hc-card__stars, .hc-modal__stars {
    color: #d4af37;
    font-size: 16px;
    letter-spacing: 2px;
    margin-bottom: 12px;
  }

  .hc-card__text {
    font-size: 14px;
    line-height: 1.5;
    color: #333;
    margin: 0 0 16px 0;
  }
  .hc-modal__review-text {
    font-size: 16px;
    line-height: 1.6;
    color: #333;
    margin: 0 0 32px 0;
  }

  .hc-card__divider, .hc-modal__divider {
    height: 1px;
    background: var(--color-border);
    margin: 0 -16px 12px -16px;
  }
  .hc-modal__divider {
    margin: 0 0 24px 0;
  }

  .hc-card__product {
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .hc-card__product-img {
    width: 40px; height: 40px;
    border-radius: 4px;
    object-fit: cover;
    border: 1px solid var(--color-border);
  }
  .hc-card__product-title {
    font-size: 12px;
    line-height: 1.4;
    color: var(--color-text-muted);
    flex: 1;
  }

  /* MODAL */
  .hc-modal {
    position: fixed;
    inset: 0;
    z-index: 99999;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
  }
  .hc-modal.is-active {
    opacity: 1;
    visibility: visible;
  }

  .hc-modal__overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.7);
    backdrop-filter: blur(5px);
  }

  .hc-modal__wrap {
    position: relative;
    background: var(--color-bg);
    width: 100%;
    max-width: 900px;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 25px 50px rgba(0,0,0,0.25);
    transform: scale(0.95) translateY(20px);
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    max-height: 90vh;
    display: flex;
    flex-direction: column;
  }
  .hc-modal.is-active .hc-modal__wrap {
    transform: scale(1) translateY(0);
  }

  .hc-modal__close {
    position: absolute;
    top: 16px;
    left: 16px; /* Floating on top of the image */
    width: 36px; height: 36px;
    background: rgba(0,0,0,0.4);
    color: #fff;
    border-radius: 50%;
    border: none;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer;
    z-index: 10;
    transition: background 0.2s;
  }
  .hc-modal__close:hover {
    background: rgba(0,0,0,0.7);
  }
  .hc-modal__close svg { width: 18px; height: 18px; }

  .hc-modal__content {
    flex: 1;
    overflow-y: auto;
  }

  .hc-modal__split {
    display: flex;
    flex-direction: column;
  }
  @media (min-width: 768px) {
    .hc-modal__split { flex-direction: row; }
  }

  .hc-modal__col-img {
    width: 100%;
    background: #000;
  }
  @media (min-width: 768px) {
    .hc-modal__col-img { width: 45%; flex-shrink: 0; }
  }
  .hc-modal__col-img img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    max-height: 50vh;
  }
  @media (min-width: 768px) {
    .hc-modal__col-img img { max-height: 80vh; }
  }

  .hc-modal__col-text {
    padding: 32px;
    width: 100%;
    display: flex;
    flex-direction: column;
  }
  @media (min-width: 768px) {
    .hc-modal__col-text { width: 55%; padding: 40px; }
  }

  .hc-modal__product-area {
    margin-top: auto; /* Push to bottom */
  }

  .hc-modal__product-info {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 20px;
  }
  .hc-modal__product-info img {
    width: 60px; height: 60px;
    border-radius: 6px;
    object-fit: cover;
    border: 1px solid var(--color-border);
  }
  .hc-modal__product-title {
    font-size: 13px;
    line-height: 1.5;
    color: var(--color-text);
    font-weight: 500;
  }

  .hc-modal__btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    width: 100%;
    padding: 14px;
    background: var(--color-bg-warm);
    color: var(--color-text);
    border: 1px solid var(--color-border);
    text-decoration: none;
    font-weight: 600;
    font-size: 14px;
    border-radius: 6px;
    transition: all 0.2s;
  }
  .hc-modal__btn:hover {
    background: #fff;
    border-color: var(--color-primary);
    color: var(--color-primary);
  }
  .hc-modal__btn svg {
    width: 18px; height: 18px;
  }
</style>

{% schema %}
{
  "name": "Happy Customers Page",
  "settings": []
}
{% endschema %}
